{% load static %}
{% load humanize %}

<div id="product-{{ product.id }}"
     class="relative bg-gray-50 rounded-xl shadow-md p-4 flex flex-col items-center group transition-transform duration-500 hover:scale-105 hover:shadow-2xl hover:-translate-y-1 cursor-pointer"
     onclick="window.location.href='{% url 'main:product_detail' product.id %}'">

  <!-- Badge Kategori -->
  <div class="absolute top-3 left-3 bg-yellow-400 text-white px-3 py-1 text-xs rounded-full font-semibold z-20 shadow-sm">
    {{ product.category }}
  </div>

  <!-- Badge Featured -->
  {% if product.is_featured %}
  <div class="absolute top-3 right-3 bg-red-500 text-white px-3 py-1 text-xs rounded-full font-semibold animate-pulse z-20 shadow-sm">
    Featured
  </div>
  {% endif %}

  <!-- Thumbnail -->
  {% if product.thumbnail %}
  <div class="relative w-full h-48 rounded-lg overflow-hidden mb-4 shadow-sm">
    <img src="{{ product.thumbnail }}" alt="{{ product.name }}"
         class="w-full h-full object-cover transition-transform duration-500 group-hover:scale-110">
    <div class="absolute inset-0 bg-black bg-opacity-20 opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-center text-white font-bold text-sm sm:text-base rounded-lg">
      Klik untuk lihat detail
    </div>
  </div>
  {% else %}
  <div class="flex items-center justify-center w-full h-48 bg-gray-200 rounded-lg text-gray-500 mb-4">
    Tidak ada gambar
  </div>
  {% endif %}

  <!-- Nama, Harga & Deskripsi Singkat -->
  <h3 class="font-poppins text-lg sm:text-xl font-semibold text-gray-900 mb-1 text-center">{{ product.name }}</h3>
  <p class="font-poppins text-gray-700 font-medium mb-2 text-center">Rp{{ product.price|intcomma }}</p>
  {% if product.description %}
  <p class="font-poppins text-gray-500 text-sm text-center mb-4">
    {{ product.description|slice:":50" }}{% if product.description|length > 50 %}...{% endif %}
  </p>
  {% endif %}

  <!-- Tombol Edit & Hapus -->
  {% if user.is_authenticated and user == product.owner or user.is_staff %}
  <div class="flex space-x-2 w-full">
    <!-- Edit AJAX -->
    <button type="button"
            onclick='event.stopPropagation(); showModal(true, {
              id: {{ product.id }},
              name: "{{ product.name|escapejs }}",
              price: {{ product.price }},
              stock: {{ product.stock }},
              description: "{{ product.description|escapejs }}",
              category: "{{ product.category|escapejs }}",
              thumbnail: "{{ product.thumbnail|escapejs }}",
              is_featured: {{ product.is_featured|yesno:"true,false" }}
            })'
            class="bg-yellow-500 text-white px-4 py-2 rounded-md hover:bg-yellow-600 flex-1">
      Edit
    </button>
    <!-- Hapus AJAX -->
    <button type="button"
            onclick="event.stopPropagation(); showDeleteModal({{ product.id }})"
            class="bg-red-600 text-white px-4 py-2 rounded-md hover:bg-red-700 flex-1">
      Hapus
    </button>
  </div>
  {% endif %}

</div>
